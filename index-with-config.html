<!DOCTYPE html>
<!--
    Copyright (C) 2014 Härnösands kommun

    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU Affero General Public License as
    published by the Free Software Foundation, either version 3 of the
    License, or (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU Affero General Public License for more details.

    You should have received a copy of the GNU Affero General Public License
    along with this program.  If not, see <http://www.gnu.org/licenses/>.
-->
<!--
	Uses parameter "configid" to open a config from Open eMap Admin service
-->

<html lang="sv">
	<head>
		<meta http-equiv="Content-type" content="text/html; charset=UTF-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<title>Open eMap Client</title>
		<meta name="description" content="">
		<meta name="author" content="Anders Erlandsson, Sundsvalls kommun" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
	
<!--	    <link rel="stylesheet" type="text/css" href="lib/ext-theme-oep/ext-theme-oep-all.css">
	    <link rel="stylesheet" type="text/css" href="resources/css/OpenEMap.css">  
	    <script type="text/javascript" src="lib/ext/ext-all.js"></script>
	    <script type="text/javascript" src="lib/ext/ext-theme-neptune.js"></script>
	    <script type="text/javascript" src="lib/ext/locale/ext-lang-sv_SE.js"></script>
	    <script type="text/javascript" src="lib/OpenLayers/OpenLayers.js"></script>
	    <script type="text/javascript" src="lib/proj4js/proj4-compressed.js"></script>
	    <script type="text/javascript" src="proj4_defs.js"></script>
	    <script type="text/javascript" src="lib/geoext/geoext-all.js"></script> 
	    <script type="text/javascript" src="lib/es5-shim/es5-shim.min.js"></script>
	    <script type="text/javascript" src="OpenEMap-debug.js"></script>
-->
    <script type="text/javascript" src="OpenEMap.js"></script>
	<script type="text/javascript">
		function idFromQueryString(queryString) {
			keyValuePairObject = {}
			keyValuePairs = queryString.split('&');
			var id = null;
			keyValuePairs.forEach(function(keyValuePair) {
				var keyValuePairArray = keyValuePair.split('=');
				if (keyValuePairArray.length === 2) {
					if (keyValuePairArray[0].toLowerCase() === 'configid' || keyValuePairArray[0].toLowerCase() === 'id') {
						id = keyValuePairArray[1]; 
					}
				}
			});
			return id;
		}
		
		var idx = window.location.href.indexOf('?');
		if (!~idx) {
			alert('Du måste ange ett konfigurationsid i url adresen t ex http://{url}/index.html?configid=16.')
		}
		var id = idFromQueryString(window.location.href.substring(idx + 1));
		
		var configUrl = '/openemapadmin-1.6.0-rc.4/adminconfigs/config/' + id;
	
		var options = {
			gui: {
				map : false,
				toolbar : {},
				zoomTools : {},
				layers : {},
				baseLayers : {},
				searchFastighet : {}
			}
		};
		
		initOpenEMap(configUrl, options)
	</script>
	</head>
	<body>
	</body>
</html>
